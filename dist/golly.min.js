/* golly.js : v0.0.1 on 09/11/2012
* http://dannyx0.github.com/golly/
* Copyright (c) 2012 Danny Garcia; Licensed MIT */
window.GOLLY=function(e){e||(e={});if(!document.createElement("canvas").getContext){e.fallback&&e.fallback();return}var t=this,n={},r=1e3,i={ctx:undefined,domElement:undefined,width:undefined,height:undefined,desiredFrameTime:r/60,frameCount:0,key:undefined,keyCode:undefined,mouseX:0,mouseY:0,pmouseX:undefined,pmouseY:undefined,mousePressed:!1,offset:{x:0,y:0}},s,o,u=function(){var e=o,t=0,n=0;while(e)n+=e.offsetTop,t+=e.offsetLeft,e=e.offsetParent;i.offset.x=t,i.offset.y=n};e.context||(e.context="2d"),o=i.domElement=document.createElement("canvas"),i.ctx=o.getContext(e.context);if(i.ctx===null){e.fallback&&e.fallback();return}if(e.fullscreen){var a=function(){u(),e.width?i.width=o.width=e.width:i.width=o.width=window.innerWidth,e.height?i.height=o.height=e.height:i.height=o.height=window.innerHeight,t.loop||t.draw&&t.draw()};window.addEventListener("resize",a,!1),a(),e.container||(document.body.style.margin="0px",document.body.style.padding="0px",document.body.style.overflow="hidden"),e.container=e.container||document.body}else e.width||(e.width=500),e.height||(e.height=500),window.addEventListener("resize",u,!1),u(),t.__defineSetter__("width",function(e){i.width=o.width=e}),t.__defineSetter__("height",function(e){i.height=o.height=e}),t.width=e.width,t.height=e.height;e.container&&(e.container.appendChild(o),u());var f=function(e){t.__defineGetter__(e,function(){return i[e]})};f("ctx"),f("domElement"),f("width"),f("height"),f("frameCount"),f("key"),f("keyCode"),f("mouseX"),f("mouseY"),f("pmouseX"),f("pmouseY"),f("mousePressed");var l=function(){};t.loop=!0,t.keyup=l,t.keydown=l,t.draw=l,t.mousedown=l,t.mouseup=l,t.mousemove=l,t.mousedrag=l,t.mouseover=l,t.mouseout=l,t.__defineGetter__("frameRate",function(e){return 1e3/s}),t.__defineGetter__("frameTime",function(e){return s}),t.__defineGetter__("keyPressed",function(e){for(var t in n)if(n[t])return!0;return!1}),t.__defineSetter__("frameTime",function(e){i.desiredFrameTime=e}),t.__defineSetter__("frameRate",function(e){i.desiredFrameTime=r/e}),o.addEventListener("mouseover",function(e){u(),t.mouseover()},!1),o.addEventListener("mouseout",function(e){u(),t.mouseout()},!1);var c=function(e){t.mousemove()},h=function(e){var t=e.pageX-i.offset.x,n=e.pageY-i.offset.y;typeof i["pmouseX"]=="undefined"?(i.pmouseX=t,i.pmouseY=n):(i.pmouseX=i.mouseX,i.pmouseY=i.mouseY),i.mouseX=t,i.mouseY=n};o.addEventListener("mousemove",h,!1),o.addEventListener("mousemove",c,!1),o.addEventListener("mousedown",function(){i.mousePressed=!0,t.mousedown(),o.addEventListener("mousemove",t.mousedrag,!1),o.removeEventListener("mousemove",c,!1)},!1),o.addEventListener("mouseup",function(){i.mousePressed=!1,t.mouseup(),o.removeEventListener("mousemove",t.mousedrag,!1),o.addEventListener("mousemove",c,!1)},!1),window.addEventListener("keydown",function(e){var r=e.keyCode;i.key=String.fromCharCode(r),i.keyCode=r,n[r]=!0,t.keydown()},!1),window.addEventListener("keyup",function(e){var r=e.keyCode;i.key=String.fromCharCode(r),i.keyCode=r,n[r]=!1,t.keyup()},!1);var p=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,s)}}();i._idraw=function(){i.frameCount++;var e=(new Date).getTime();t.draw();var n=(new Date).getTime()-e;n>i.desiredFrameTime?s=n:s=i.desiredFrameTime,t.loop&&p(i._idraw)},i._idraw()};