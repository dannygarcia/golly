/*! golly.js - v0.0.1 - 2012-09-11
* http://dannyx0.github.com/golly/
* Copyright (c) 2012 Danny Garcia; Licensed MIT */
window.GOLLY=function(e){e||(e={});if(!document.createElement("canvas").getContext){e.fallback&&e.fallback();return}var t=this,n={},r={ctx:undefined,domElement:undefined,width:undefined,height:undefined,desiredFrameTime:1e3/60,frameCount:0,key:undefined,keyCode:undefined,mouseX:0,mouseY:0,pmouseX:undefined,pmouseY:undefined,mousePressed:!1,offset:{x:0,y:0}},i,s,o=function(){var e=s,t=0,n=0;while(e)n+=e.offsetTop,t+=e.offsetLeft,e=e.offsetParent;r.offset.x=t,r.offset.y=n};e.context||(e.context="2d"),s=r.domElement=document.createElement("canvas"),r.ctx=s.getContext(e.context);if(r.ctx===null){e.fallback&&e.fallback();return}if(e.fullscreen){var u=function(){o(),e.width?r.width=s.width=e.width:r.width=s.width=window.innerWidth,e.height?r.height=s.height=e.height:r.height=s.height=window.innerHeight,t.loop||t.draw&&t.draw()};window.addEventListener("resize",u,!1),u(),e.container||(document.body.style.margin="0px",document.body.style.padding="0px",document.body.style.overflow="hidden"),e.container=e.container||document.body}else e.width||(e.width=500),e.height||(e.height=500),window.addEventListener("resize",o,!1),o(),t.__defineSetter__("width",function(e){r.width=s.width=e}),t.__defineSetter__("height",function(e){r.height=s.height=e}),t.width=e.width,t.height=e.height;e.container&&(e.container.appendChild(s),o());var a=function(e){t.__defineGetter__(e,function(){return r[e]})};a("ctx"),a("domElement"),a("width"),a("height"),a("frameCount"),a("key"),a("keyCode"),a("mouseX"),a("mouseY"),a("pmouseX"),a("pmouseY"),a("mousePressed");var f=function(){};t.loop=!0,t.keyup=f,t.keydown=f,t.draw=f,t.mousedown=f,t.mouseup=f,t.mousemove=f,t.mousedrag=f,t.mouseover=f,t.mouseout=f,t.__defineGetter__("frameRate",function(e){return 1e3/i}),t.__defineGetter__("frameTime",function(e){return i}),t.__defineGetter__("keyPressed",function(e){for(var t in n)if(n[t])return!0;return!1}),t.__defineSetter__("frameTime",function(e){r.desiredFrameTime=e}),t.__defineSetter__("frameRate",function(e,t){r.desiredFrameTime=t/e}),s.addEventListener("mouseover",function(e){o(),t.mouseover()},!1),s.addEventListener("mouseout",function(e){o(),t.mouseout()},!1);var l=function(e){t.mousemove()},c=function(e){var t=e.pageX-r.offset.x,n=e.pageY-r.offset.y;typeof r["pmouseX"]=="undefined"?(r.pmouseX=t,r.pmouseY=n):(r.pmouseX=r.mouseX,r.pmouseY=r.mouseY),r.mouseX=t,r.mouseY=n};s.addEventListener("mousemove",c,!1),s.addEventListener("mousemove",l,!1),s.addEventListener("mousedown",function(){r.mousePressed=!0,t.mousedown(),s.addEventListener("mousemove",t.mousedrag,!1),s.removeEventListener("mousemove",l,!1)},!1),s.addEventListener("mouseup",function(){r.mousePressed=!1,t.mouseup(),s.removeEventListener("mousemove",t.mousedrag,!1),s.addEventListener("mousemove",l,!1)},!1),window.addEventListener("keydown",function(e){var i=e.keyCode;r.key=String.fromCharCode(i),r.keyCode=i,n[i]=!0,t.keydown()},!1),window.addEventListener("keyup",function(e){var i=e.keyCode;r.key=String.fromCharCode(i),r.keyCode=i,n[i]=!1,t.keyup()},!1);var h=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,i)}}();r._idraw=function(){r.frameCount++;var e=(new Date).getTime();t.draw();var n=(new Date).getTime()-e;n>r.desiredFrameTime?i=n:i=r.desiredFrameTime,t.loop&&h(r._idraw)},r._idraw()};